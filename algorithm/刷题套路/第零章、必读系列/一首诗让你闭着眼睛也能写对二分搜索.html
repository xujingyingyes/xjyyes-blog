<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一首诗让你闭着眼睛也能写对二分搜索 | 前端仙女徐</title>
    <meta name="description" content="徐静莹同学的个人博客">
    <link rel="icon" href="/logo.ico">
    
    <link rel="preload" href="/assets/css/0.styles.4dce7a13.css" as="style"><link rel="preload" href="/assets/js/app.e83a5f29.js" as="script"><link rel="preload" href="/assets/js/45.59e01ccf.js" as="script"><link rel="prefetch" href="/assets/js/10.9bf68c24.js"><link rel="prefetch" href="/assets/js/100.9e9a62bb.js"><link rel="prefetch" href="/assets/js/101.61c9bd24.js"><link rel="prefetch" href="/assets/js/102.d291c10c.js"><link rel="prefetch" href="/assets/js/103.15eafb21.js"><link rel="prefetch" href="/assets/js/104.5318596c.js"><link rel="prefetch" href="/assets/js/105.77e39186.js"><link rel="prefetch" href="/assets/js/106.ddb9bd9d.js"><link rel="prefetch" href="/assets/js/107.f25bfe06.js"><link rel="prefetch" href="/assets/js/108.ab649be7.js"><link rel="prefetch" href="/assets/js/109.e71577f7.js"><link rel="prefetch" href="/assets/js/11.b96d27c8.js"><link rel="prefetch" href="/assets/js/110.85d14e9b.js"><link rel="prefetch" href="/assets/js/111.f3a3d0c8.js"><link rel="prefetch" href="/assets/js/112.c2b76adc.js"><link rel="prefetch" href="/assets/js/113.8c5333c0.js"><link rel="prefetch" href="/assets/js/114.b6cd0c28.js"><link rel="prefetch" href="/assets/js/115.c3ef3452.js"><link rel="prefetch" href="/assets/js/116.903a6512.js"><link rel="prefetch" href="/assets/js/117.591085e6.js"><link rel="prefetch" href="/assets/js/118.caaa5f80.js"><link rel="prefetch" href="/assets/js/119.31b0c764.js"><link rel="prefetch" href="/assets/js/12.71ebb132.js"><link rel="prefetch" href="/assets/js/120.16707500.js"><link rel="prefetch" href="/assets/js/121.a562e32a.js"><link rel="prefetch" href="/assets/js/122.e906150e.js"><link rel="prefetch" href="/assets/js/123.58808afd.js"><link rel="prefetch" href="/assets/js/124.5e412684.js"><link rel="prefetch" href="/assets/js/125.0842285e.js"><link rel="prefetch" href="/assets/js/126.6918ab37.js"><link rel="prefetch" href="/assets/js/127.e03399cd.js"><link rel="prefetch" href="/assets/js/128.5ef2f2f5.js"><link rel="prefetch" href="/assets/js/129.126a105a.js"><link rel="prefetch" href="/assets/js/13.d9683182.js"><link rel="prefetch" href="/assets/js/130.5b1ff597.js"><link rel="prefetch" href="/assets/js/131.dd495b27.js"><link rel="prefetch" href="/assets/js/132.74f93241.js"><link rel="prefetch" href="/assets/js/133.0a150027.js"><link rel="prefetch" href="/assets/js/134.f80b60f1.js"><link rel="prefetch" href="/assets/js/135.3c27f662.js"><link rel="prefetch" href="/assets/js/136.a243d279.js"><link rel="prefetch" href="/assets/js/137.2dc71986.js"><link rel="prefetch" href="/assets/js/138.009eec67.js"><link rel="prefetch" href="/assets/js/139.5b4c31a9.js"><link rel="prefetch" href="/assets/js/14.e15840dd.js"><link rel="prefetch" href="/assets/js/140.a14b3625.js"><link rel="prefetch" href="/assets/js/141.1dc974bb.js"><link rel="prefetch" href="/assets/js/142.24bfef7f.js"><link rel="prefetch" href="/assets/js/143.a0d75d2b.js"><link rel="prefetch" href="/assets/js/144.e0cc6586.js"><link rel="prefetch" href="/assets/js/145.c0d80bb4.js"><link rel="prefetch" href="/assets/js/146.bbb34e97.js"><link rel="prefetch" href="/assets/js/147.5fbf263d.js"><link rel="prefetch" href="/assets/js/148.4f7471a0.js"><link rel="prefetch" href="/assets/js/149.6fe1bf0b.js"><link rel="prefetch" href="/assets/js/15.4bb7576f.js"><link rel="prefetch" href="/assets/js/150.0bff6648.js"><link rel="prefetch" href="/assets/js/151.b071bbff.js"><link rel="prefetch" href="/assets/js/152.61b9d65a.js"><link rel="prefetch" href="/assets/js/153.2aa93ee7.js"><link rel="prefetch" href="/assets/js/16.b02c9893.js"><link rel="prefetch" href="/assets/js/17.28216e68.js"><link rel="prefetch" href="/assets/js/18.5581c04d.js"><link rel="prefetch" href="/assets/js/19.0dc41dcd.js"><link rel="prefetch" href="/assets/js/2.1cf5bce0.js"><link rel="prefetch" href="/assets/js/20.cbe945bb.js"><link rel="prefetch" href="/assets/js/21.ba224c00.js"><link rel="prefetch" href="/assets/js/22.1dbec404.js"><link rel="prefetch" href="/assets/js/23.50adfd98.js"><link rel="prefetch" href="/assets/js/24.37e42526.js"><link rel="prefetch" href="/assets/js/25.c299d5e5.js"><link rel="prefetch" href="/assets/js/26.ebfabf35.js"><link rel="prefetch" href="/assets/js/27.dea97e79.js"><link rel="prefetch" href="/assets/js/28.eabb3764.js"><link rel="prefetch" href="/assets/js/29.c20e514f.js"><link rel="prefetch" href="/assets/js/3.31fb7e44.js"><link rel="prefetch" href="/assets/js/30.53013327.js"><link rel="prefetch" href="/assets/js/31.fd722ef9.js"><link rel="prefetch" href="/assets/js/32.ff907c26.js"><link rel="prefetch" href="/assets/js/33.e06f8662.js"><link rel="prefetch" href="/assets/js/34.00050cf4.js"><link rel="prefetch" href="/assets/js/35.6ecb793c.js"><link rel="prefetch" href="/assets/js/36.09dc2217.js"><link rel="prefetch" href="/assets/js/37.2b2a51b3.js"><link rel="prefetch" href="/assets/js/38.570bf4b9.js"><link rel="prefetch" href="/assets/js/39.419b86d2.js"><link rel="prefetch" href="/assets/js/4.74622458.js"><link rel="prefetch" href="/assets/js/40.7f1c1703.js"><link rel="prefetch" href="/assets/js/41.0b765365.js"><link rel="prefetch" href="/assets/js/42.da029d6b.js"><link rel="prefetch" href="/assets/js/43.b0f25fe2.js"><link rel="prefetch" href="/assets/js/44.adb9aa1d.js"><link rel="prefetch" href="/assets/js/46.54f93231.js"><link rel="prefetch" href="/assets/js/47.2f3640d7.js"><link rel="prefetch" href="/assets/js/48.82d25e22.js"><link rel="prefetch" href="/assets/js/49.da557fcf.js"><link rel="prefetch" href="/assets/js/5.6ad929c0.js"><link rel="prefetch" href="/assets/js/50.222d0909.js"><link rel="prefetch" href="/assets/js/51.db9523b3.js"><link rel="prefetch" href="/assets/js/52.6311757c.js"><link rel="prefetch" href="/assets/js/53.2d42ca00.js"><link rel="prefetch" href="/assets/js/54.cd56d259.js"><link rel="prefetch" href="/assets/js/55.f71bea17.js"><link rel="prefetch" href="/assets/js/56.15d50408.js"><link rel="prefetch" href="/assets/js/57.48e80cbb.js"><link rel="prefetch" href="/assets/js/58.461b5327.js"><link rel="prefetch" href="/assets/js/59.054a93db.js"><link rel="prefetch" href="/assets/js/6.6d229baf.js"><link rel="prefetch" href="/assets/js/60.d877fa11.js"><link rel="prefetch" href="/assets/js/61.ad72d9fa.js"><link rel="prefetch" href="/assets/js/62.c20ac15b.js"><link rel="prefetch" href="/assets/js/63.9d9c6aff.js"><link rel="prefetch" href="/assets/js/64.bbf5729b.js"><link rel="prefetch" href="/assets/js/65.9481f79e.js"><link rel="prefetch" href="/assets/js/66.d1cf7af4.js"><link rel="prefetch" href="/assets/js/67.2ab019a5.js"><link rel="prefetch" href="/assets/js/68.fc4ee542.js"><link rel="prefetch" href="/assets/js/69.a00f611c.js"><link rel="prefetch" href="/assets/js/7.074b39d8.js"><link rel="prefetch" href="/assets/js/70.661d4637.js"><link rel="prefetch" href="/assets/js/71.bba94ec2.js"><link rel="prefetch" href="/assets/js/72.06dc9dee.js"><link rel="prefetch" href="/assets/js/73.4732b71d.js"><link rel="prefetch" href="/assets/js/74.68ea9ff2.js"><link rel="prefetch" href="/assets/js/75.2847de03.js"><link rel="prefetch" href="/assets/js/76.f698a0e0.js"><link rel="prefetch" href="/assets/js/77.7ff536b5.js"><link rel="prefetch" href="/assets/js/78.46a8aa86.js"><link rel="prefetch" href="/assets/js/79.46773283.js"><link rel="prefetch" href="/assets/js/8.6a74ded2.js"><link rel="prefetch" href="/assets/js/80.2f4f703f.js"><link rel="prefetch" href="/assets/js/81.c367dc5d.js"><link rel="prefetch" href="/assets/js/82.e4eb33d1.js"><link rel="prefetch" href="/assets/js/83.18d741ec.js"><link rel="prefetch" href="/assets/js/84.9bdd3df5.js"><link rel="prefetch" href="/assets/js/85.bc0eea18.js"><link rel="prefetch" href="/assets/js/86.83566ae8.js"><link rel="prefetch" href="/assets/js/87.13006ea3.js"><link rel="prefetch" href="/assets/js/88.0f264fbd.js"><link rel="prefetch" href="/assets/js/89.df6d2044.js"><link rel="prefetch" href="/assets/js/9.2a18e431.js"><link rel="prefetch" href="/assets/js/90.7da95c45.js"><link rel="prefetch" href="/assets/js/91.9edee027.js"><link rel="prefetch" href="/assets/js/92.8b6aea1b.js"><link rel="prefetch" href="/assets/js/93.6200ded4.js"><link rel="prefetch" href="/assets/js/94.27ac3f76.js"><link rel="prefetch" href="/assets/js/95.4d4682b8.js"><link rel="prefetch" href="/assets/js/96.9cffa88b.js"><link rel="prefetch" href="/assets/js/97.300b46ec.js"><link rel="prefetch" href="/assets/js/98.e6210aca.js"><link rel="prefetch" href="/assets/js/99.4175c212.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4dce7a13.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端仙女徐</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文章</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/QDSkill/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/frame/" class="nav-link">框架</a></li><li class="dropdown-item"><!----> <a href="/frontEndCommunication/" class="nav-link">前后端通信</a></li><li class="dropdown-item"><!----> <a href="/performanceOptimization/" class="nav-link">性能优化</a></li><li class="dropdown-item"><!----> <a href="/browserRendering/" class="nav-link">浏览器渲染</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/xujingyingyes/xujingyingyes.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/faceStorage/" class="nav-link">面经</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link router-link-active">算法</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文章</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/QDSkill/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/frame/" class="nav-link">框架</a></li><li class="dropdown-item"><!----> <a href="/frontEndCommunication/" class="nav-link">前后端通信</a></li><li class="dropdown-item"><!----> <a href="/performanceOptimization/" class="nav-link">性能优化</a></li><li class="dropdown-item"><!----> <a href="/browserRendering/" class="nav-link">浏览器渲染</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/xujingyingyes/xujingyingyes.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/faceStorage/" class="nav-link">面经</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link router-link-active">算法</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>算法</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/algorithm/算法前置.html" class="sidebar-link">算法前置</a></li><li><a href="/algorithm/并查集.html" class="sidebar-link">并查集</a></li><li><a href="/algorithm/动态规划.html" class="sidebar-link">动态规划</a></li><li><a href="/algorithm/二叉树.html" class="sidebar-link">二叉树</a></li><li><a href="/algorithm/二分法.html" class="sidebar-link">二分法</a></li><li><a href="/algorithm/复杂度.html" class="sidebar-link">时间复杂度</a></li><li><a href="/algorithm/哈希表.html" class="sidebar-link">哈希表</a></li><li><a href="/algorithm/回溯算法.html" class="sidebar-link">回溯算法</a></li><li><a href="/algorithm/矩阵.html" class="sidebar-link">矩阵</a></li><li><a href="/algorithm/链表.html" class="sidebar-link">链表</a></li><li><a href="/algorithm/排序算法.html" class="sidebar-link">排序算法</a></li><li><a href="/algorithm/双指针.html" class="sidebar-link">双指针</a></li><li><a href="/algorithm/贪心算法.html" class="sidebar-link">贪心</a></li><li><a href="/algorithm/栈和队列.html" class="sidebar-link">用栈实现队列</a></li><li><a href="/algorithm/字符串.html" class="sidebar-link">字符串</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/动态规划题解套路框架.html" class="sidebar-link">动态规划解题套路框架</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/回溯算法解题套路框架.html" class="sidebar-link">回溯算法解题套路框架</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/教你几招算法笔试题的套路.html" class="sidebar-link">教你几招算法笔试题的套路</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/经典动态规划：子集背包问题.html" class="sidebar-link">经典动态规划：子集背包问题</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/学习算法和刷题的框架思维.html" class="sidebar-link">学习算法和刷题的框架思维</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/一个方法团灭股票买卖问题.html" class="sidebar-link">一个方法团灭股票买卖问题</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/一首诗让你把滑动窗口算法变成默写题.html" class="sidebar-link">一首诗让你把滑动窗口算法变成默写题</a></li><li><a href="/algorithm/刷题套路/第零章、必读系列/一首诗让你闭着眼睛也能写对二分搜索.html" class="active sidebar-link">一首诗让你闭着眼睛也能写对二分搜索</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/algorithm/刷题套路/第零章、必读系列/一首诗让你闭着眼睛也能写对二分搜索.html#二分查找框架" class="sidebar-link">二分查找框架</a></li><li class="sidebar-sub-header"><a href="/algorithm/刷题套路/第零章、必读系列/一首诗让你闭着眼睛也能写对二分搜索.html#寻找一个数（基本的二分搜索）" class="sidebar-link">寻找一个数（基本的二分搜索）</a></li><li class="sidebar-sub-header"><a href="/algorithm/刷题套路/第零章、必读系列/一首诗让你闭着眼睛也能写对二分搜索.html#寻找左侧边界的二分搜索" class="sidebar-link">寻找左侧边界的二分搜索</a></li><li class="sidebar-sub-header"><a href="/algorithm/刷题套路/第零章、必读系列/一首诗让你闭着眼睛也能写对二分搜索.html#寻找右侧边界的二分搜索" class="sidebar-link">寻找右侧边界的二分搜索</a></li></ul></li><li><a href="/algorithm/刷题套路/第零章、必读系列/BFS算法解题套路框架.html" class="sidebar-link">BFS 算法解题套路框架</a></li><li><a href="/algorithm/刷题套路/动态规划系列/动态规划答疑篇.html" class="sidebar-link">动态规划答疑篇</a></li><li><a href="/algorithm/刷题套路/动态规划系列/动态规划设计：最大子数组.html" class="sidebar-link">动态规划设计：最大子数组</a></li><li><a href="/algorithm/刷题套路/动态规划系列/动态规划设计：最长递增子序列.html" class="sidebar-link">动态规划设计：最长递增子序列</a></li><li><a href="/algorithm/刷题套路/动态规划系列/动态规划题解套路框架.html" class="sidebar-link">动态规划解题套路框架</a></li><li><a href="/algorithm/刷题套路/动态规划系列/状态压缩：对动态规划进行降维打击.html" class="sidebar-link">状态压缩：对动态规划进行降维打击</a></li><li><a href="/algorithm/刷题套路/数据结构系列/二叉树的序列化与反序列化.html" class="sidebar-link">二叉树的序列化与反序列化</a></li><li><a href="/algorithm/刷题套路/数据结构系列/手把手带你刷二叉树（一期）.html" class="sidebar-link">手把手带你刷二叉树（一期）</a></li><li><a href="/algorithm/刷题套路/数据结构系列/手把手带你刷二叉树（二期）.html" class="sidebar-link">手把手带你刷二叉树（二期）</a></li><li><a href="/algorithm/刷题套路/数据结构系列/手把手带你刷二叉树（三期）.html" class="sidebar-link">手把手带你刷二叉树（三期）</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="一首诗让你闭着眼睛也能写对二分搜索"><a href="#一首诗让你闭着眼睛也能写对二分搜索" class="header-anchor">#</a> 一首诗让你闭着眼睛也能写对二分搜索</h1> <p>二分查找并不简单，Knuth 大佬（发明 KMP 算法的那位）都说二分查找： <strong>思路很简单，细节是魔鬼。</strong> 很多人喜欢拿整型溢出的 bug 说事儿，但是二分查找真正的坑根本就不是那个细节问题，而是在于到底要给 mid 加一还是减一，while 里面到底用 <code>&lt;=</code> 还是 <code>&lt;</code> 。</p> <p>你要是没有正确理解这些细节，写二分肯定就是选学编程，有没有 bug 只能靠菩萨保佑。 <strong>这里有一首诗来歌颂算法，概括本文的主要内容，建议保存：</strong></p> <p><img src="https://gblobscdn.gitbook.com/assets%2F-LrtQOWSnDdXhp3kYN4k%2Fsync%2F6262c33549e980c22758927d7a57280b5213ed3f.png?alt=media" alt="img"></p> <p>本文就来探究几个最常见的二分查找场景：寻找一个数、寻找左侧边界、寻找右侧边界。而且我们就是要深入细节，比如不等号是否应该带等号，mid 是否应该加一等等。分析这些细节的差异以及出现这些差异的原因，保证你能灵活准确地写出正确的二分查找算法。</p> <h2 id="二分查找框架"><a href="#二分查找框架" class="header-anchor">#</a> 二分查找框架</h2> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span><span class="token parameter">nums<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token operator">...</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token keyword">let</span> mid <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
  	<span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">===</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      left <span class="token operator">=</span> <span class="token operator">...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&gt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      right <span class="token operator">=</span> <span class="token operator">...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>分析二分查找的技巧是：不要出现 else，而是把所有情况都用 else if 写清楚，这样可以清楚地展现所有细节。</strong></p> <p>其中 ... 标记的地方，就是可能出现细节问题的地方，当你见到一个二分查找的代码时，首先注意这几个地方，后面会用例子分析这些地方会有什么变化。</p> <p>另外声明一下，计算 mid 时需要防止溢出，代码中 <code>left + (right - left) / 2</code> 和 <code>(left + right) / 2</code> 的结果相同，但是有效防止了 left 和 right 太大直接相加导致溢出。</p> <h2 id="寻找一个数（基本的二分搜索）"><a href="#寻找一个数（基本的二分搜索）" class="header-anchor">#</a> 寻找一个数（基本的二分搜索）</h2> <p>这个场景是最简单的，肯定也是最熟悉的，即搜索一个数，如果存在返回索引，否则返回 -1.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span><span class="token parameter">nums<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> left <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token comment">// 注意</span>
  
  <span class="token keyword">while</span><span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mid <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">===</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> mid
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> 
      left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment">// 注意</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&gt;</span> target<span class="token punctuation">)</span>
      right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span> <span class="token comment">// 注意</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li><p><strong>为什么 while 循环的条件中 &lt;=，而不是 &lt; ？</strong></p> <p>因为初始化 right 的赋值是 <code>nums.length - 1</code> ，即最后一个元素的索引，而不是 <code>nums.length</code> 。</p> <p>这二者可能出现在不同功能的二分搜索中，区别是：前者相当于两端都是闭区间 <code>[left, right]</code> ，后者相当于左闭右开区间 <code>[left, right)</code> ，因为索引大小为 <code>nums.length</code> 是越界的。</p> <p>我们这个算法中使用是前者的双端闭区间， <strong>这个区间其实就是每次进行搜索的区间。</strong></p> <p>什么时候应该停止搜索呢？当然是找到目标值的时候可以停止：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">===</span> target<span class="token punctuation">)</span> <span class="token keyword">return</span> mid
</code></pre></div><p>但是如果没有找到，while 也跳出了循环，此时应该按照题意返回 -1。那么什么时候应该终止循环呢，即左指针和右指针交叉之后，此时终止循环。</p></li> <li><p><strong>为什么 <code>left = mid + 1</code> ， <code>right = mid - 1</code> ？有的代码是 <code>left = mid</code> 或者 <code>right = mid</code> ？应该怎么判断</strong></p> <p>这也是二分查找的一个难点，不过只要你能理解前面的内容，就能够很容易判断。</p> <p>刚才明确了「搜索区间」这个概念，而且本算法的搜索区间是两端都闭合的，即 <code>[left, right]</code> ，那么当我们发现 mid 不是要找的 target 时，此时应该搜索 <code>[left, mid - 1]</code> 或者 <code>[mid + 1, right]</code> ，因为 mid 已经查找过了，应当中搜索区间中取出。</p></li> <li><p><strong>此算法有什么缺陷？</strong></p> <p>至此，你应该掌握了该算法的所有细节，以及这样处理的原因。但是这个算法存在局限性。</p> <p>比如说给你有序数组 <code>nums = [1, 2, 2, 2, 3]</code> ，target 为 2，此算法返回的索引是 2，没错，但是如果我想得到 target 的左侧边界，即索引 1，或者我想得到 target 的右侧索引，即索引 3，这样的话此算法是无法处理的。</p> <p>这样的需求很常见， <strong>你也许会说，找到一个 target，然后向左或向右线性搜索不行吗？</strong> 可以，但是不好，因为这样难以保证二分查找对数级的复杂度了。</p></li></ol> <h2 id="寻找左侧边界的二分搜索"><a href="#寻找左侧边界的二分搜索" class="header-anchor">#</a> 寻找左侧边界的二分搜索</h2> <p>以下是最常见的代码形式，其中的标记是需要注意的细节：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">leftBound</span><span class="token punctuation">(</span><span class="token parameter">nums<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
  
  <span class="token keyword">let</span> left <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token comment">// 注意</span>
  
  <span class="token keyword">while</span><span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 注意</span>
    <span class="token keyword">let</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">===</span> target<span class="token punctuation">)</span> right <span class="token operator">=</span> mid
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> 
      left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&gt;</span> target<span class="token punctuation">)</span> 
      right <span class="token operator">=</span> mid
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> left
<span class="token punctuation">}</span>
</code></pre></div><ol><li><p><strong>为什么 while 是 &lt; 而不是 <code>&lt;=</code> ?</strong></p> <p>因为 <code>right = nums.length</code> 而不是 <code>nums.length - 1</code>。因此每次循环的「搜索区间」是 <code>[left, right)</code> 左闭右开。</p> <p><code>while(left &lt; right)</code> 终止的条件是 <code>left == right</code>，此时搜索区间 <code>[left, left)</code> 为空，所以可以正确终止。</p> <blockquote><p>PS：这里先要说一个搜索左右边界和上面这个算法的一个区别，也是很多读者问的：<strong>刚才的</strong> <strong><code>right</code></strong> <strong>不是</strong> <strong><code>nums.length - 1</code></strong> <strong>吗，为啥这里非要写成</strong> <strong><code>nums.length</code></strong> <strong>使得「搜索区间」变成左闭右开呢</strong>？</p></blockquote> <p>因为对于搜索左右侧边界的二分查找，这种写法比较普遍，我就拿这种写法举例了，保证你以后遇到这类代码可以理解。你非要用两端都闭的写法反而更简单，我会在后面写相关的代码，把三种二分搜索都用一种两端都闭的写法统一起来，你耐心往后看就行了。</p></li> <li><p><strong>为什么没有返回 -1 的操作？如果 nums 中不存在 target 这个值怎么办？</strong></p> <p>因为要一步一步来，先理解一下这个「左侧边界」有什么特殊含义：</p> <p><img src="https://gblobscdn.gitbook.com/assets%2F-LrtQOWSnDdXhp3kYN4k%2Fsync%2Fda0a55ba889b5c1682dee99f8180d2bfcea66610.jpg?alt=media" alt="img"></p> <p>对于这个数组，算法会返回 1，这个 1 的含义可以这样解读：nums 中小于 2 的元素有 1 个。</p> <p>必须对于有序数组 <code>nums = [2, 3, 5, 7]</code> ，<code>target = 1</code> ，算法会返回 0，含义是：nums 中小于 1 的元素有 0 个。</p> <p>总还是那个可以看出，函数的返回值（即 left 变量的值）取值区间是闭区间 <code>[0, nums.length]</code> ，所以我们简单添加两行代码就能在正确的时候 return -1：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
<span class="token comment">// target 比所有数都大</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">// 类似之前算法的处理方式</span>
<span class="token keyword">return</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">===</span> target <span class="token operator">?</span> left <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><strong>为什么 <code>left = mid + 1</code> ，<code>right = mid</code> 呢？</strong></p> <p>因为搜索区间是左闭右开，所以是这样。</p></li> <li><p><strong>为什么返回 left，而不是 right？</strong></p> <p>都一样，反正最后结果是相等的。</p></li> <li><p><strong>为什么该算法能够搜索左侧边界？</strong></p> <p>关键在于对于 <code>nums[mid] === target</code> 这种情况的处理：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span>
	right <span class="token operator">=</span> mid<span class="token punctuation">;</span>
</code></pre></div><p>可见，找到 target 时不要立即返回，而是缩小「搜索区间」的上界 right，在区间 <code>[left, mid)</code> 中继续搜索，即不断向左收缩，达到锁定左侧边界的目的。</p></li> <li><p><strong>能不能想办法把 right 变成 <code>nums.length - 1</code> ，也就是继续使用两边都闭区间，这样就可以和第一种方式统一起来了。</strong></p> <p>当然可以，只要你明白了「搜索区间」这个概念，就能有效避免漏掉元素，随便怎么改都可以。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">left_bound</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// 搜索区间为 [left, right]</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 搜索区间变为 [mid+1, right]</span>
            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&gt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 搜索区间变为 [left, mid-1]</span>
            right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 收缩右侧边界</span>
            right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 检查出界情况</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">&gt;=</span> nums<span class="token punctuation">.</span>length <span class="token operator">||</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">!=</span> target<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>完整代码如上。</p></li></ol> <h2 id="寻找右侧边界的二分搜索"><a href="#寻找右侧边界的二分搜索" class="header-anchor">#</a> 寻找右侧边界的二分搜索</h2> <p>实现思路和寻找左侧边界的算法一致，这里直接给答案。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">right_bound</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 注意</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&gt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            right <span class="token operator">=</span> mid<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> left <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 注意</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> <span class="token function">right_bound</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> mid <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&gt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 这里改成收缩左侧边界即可</span>
            left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 这里改为检查 right 越界的情况，见下图</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">!=</span> target<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">11/3/2020, 12:06:36 AM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.e83a5f29.js" defer></script><script src="/assets/js/45.59e01ccf.js" defer></script>
  </body>
</html>
